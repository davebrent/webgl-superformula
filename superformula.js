!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){function r(t,e){return t.getContext("webgl",e)||t.getContext("experimental-webgl",e)}function o(t,e,n,r){var o=window.devicePixelRatio||1;t.width=n*o,t.height=r*o,t.style.width=n+"px",t.style.height=r+"px",e.viewportWidth=n*o,e.viewportHeight=r*o,e.viewport(0,0,e.viewportWidth,e.viewportHeight)}function i(t,e,n){var r=t.createShader(e);if(t.shaderSource(r,n),t.compileShader(r),""!==t.getShaderInfoLog(r)){for(var o=n.split("\n"),i=0;i<o.length;i++)o[i]=i+1+":	"+o[i];throw console.log(o.join("\n")),new Error(t.getShaderInfoLog(r))}if(t.getShaderParameter(r,t.COMPILE_STATUS)===!1)throw new Error("Shader couldn't compile.");return r}function a(t){var e,n,r,o,i,a,s,u,l,c,d=[],h=[],f=[];for(n=0;t>=n;n++)for(l=n/t*360/180*Math.PI,e=0;t>=e;e++){c=e/t*360/180*Math.PI;var r=1-e/t,o=1-n/t;d.push(c),d.push(l),f.push(r),f.push(o)}for(n=0;t>n;n++)for(e=0;t>e;e++)i=n*(t+1)+e,a=i+t+1,s=i+1,u=a+1,h.push(i),h.push(a),h.push(s),h.push(a),h.push(u),h.push(s);return{vertices:new Float32Array(d),indices:new Uint16Array(h),uvs:new Float32Array(f)}}function s(t,e,n,r,o){var i={buffer:t.createBuffer(),itemSize:r,numItems:void 0===o?n.length/r:o};return t.bindBuffer(e,i.buffer),t.bufferData(e,n,t.STATIC_DRAW),i}function u(t,e){var n=new c.GUI,r={rendering:{"Auto-rotate":!0,"Draw mode":t.LINES,Background:[0,0,0],"Point size":.75},morph:{"Shape A morph":.5,"Shape B morph":.5,"Shape morph":.5,"Type morph":.5},shape1:{m:2,n1:2,n2:1,n3:3,Scale:.75},shape2:{m:3,n1:6,n2:5,n3:6,Scale:.75}},o=n.addFolder("Rendering");o.add(r.rendering,"Auto-rotate").onChange(e),o.add(r.rendering,"Draw mode",{Points:t.POINTS,Lines:t.LINES,"Line loop":t.LINE_LOOP,"Line strip":t.LINE_STRIP,Triangles:t.TRIANGLES,"Triangle strip":t.TRIANGLE_STRIP,"Triangle fan":t.TRIANGLE_FAN}).onChange(e),o.addColor(r.rendering,"Background").onChange(e),o.add(r.rendering,"Point size",0,4).onChange(e),o.open();var i=n.addFolder("Morph");i.add(r.morph,"Shape A morph",0,1).onChange(e),i.add(r.morph,"Shape B morph",0,1).onChange(e),i.add(r.morph,"Shape morph",0,1).onChange(e),i.add(r.morph,"Type morph",0,1).onChange(e),i.open();var a=n.addFolder("Superformula A");a.add(r.shape1,"m",1,50).step(1).onChange(e),a.add(r.shape1,"n1",1,50).step(1).onChange(e),a.add(r.shape1,"n2",1,50).step(1).onChange(e),a.add(r.shape1,"n3",1,50).step(1).onChange(e),a.add(r.shape1,"Scale",0,2).onChange(e),a.open();var s=n.addFolder("Superformula B");return s.add(r.shape2,"m",1,50).step(1).onChange(e),s.add(r.shape2,"n1",1,50).step(1).onChange(e),s.add(r.shape2,"n2",1,50).step(1).onChange(e),s.add(r.shape2,"n3",1,50).step(1).onChange(e),s.add(r.shape2,"Scale",0,2).onChange(e),s.open(),e(r),r}function l(t,e){e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.frontFace(e.CCW),e.cullFace(e.BACK),e.enable(e.CULL_FACE),o(t,e,window.innerWidth,window.innerHeight),window.addEventListener("resize",function(){o(t,e,window.innerWidth,window.innerHeight)},!1);var n=i(e,e.VERTEX_SHADER,h()),r=i(e,e.FRAGMENT_SHADER,f()),l=e.createProgram();e.attachShader(l,n),e.attachShader(l,r),e.linkProgram(l),l.uniforms={m:e.getUniformLocation(l,"m"),n1:e.getUniformLocation(l,"n1"),n2:e.getUniformLocation(l,"n2"),n3:e.getUniformLocation(l,"n3"),scale:e.getUniformLocation(l,"scale"),pointSize:e.getUniformLocation(l,"pointSize"),projectionMatrix:e.getUniformLocation(l,"projectionMatrix"),modelViewMatrix:e.getUniformLocation(l,"modelViewMatrix"),typeMorph:e.getUniformLocation(l,"typeMorph"),shapeMorph:e.getUniformLocation(l,"shapeMorph"),shapeAMorph:e.getUniformLocation(l,"shapeAMorph"),shapeBMorph:e.getUniformLocation(l,"shapeBMorph")},l.attributes={position:e.getAttribLocation(l,"position")},e.enableVertexAttribArray(l.attributes.position);var c=a(96),p={uv:s(e,e.ARRAY_BUFFER,c.uvs,2),position:s(e,e.ARRAY_BUFFER,c.vertices,2),index:s(e,e.ELEMENT_ARRAY_BUFFER,c.indices,1)};delete c,e.vertexAttribPointer(l.attributes.uv,p.uv.itemSize,e.FLOAT,!1,0,0),e.vertexAttribPointer(l.attributes.position,p.position.itemSize,e.FLOAT,!1,0,0);var m=d.mat4.create(),_=d.mat4.create();e.useProgram(l),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,p.index.buffer);var g=u(e,function(t){{var n=void 0===g?t:g,r=n.rendering.Background;n.rendering.Color}e.clearColor(r[0]/255,r[1]/255,r[2]/255,1),e.uniform2fv(l.uniforms.m,[n.shape1.m,n.shape2.m]),e.uniform2fv(l.uniforms.n1,[n.shape1.n1,n.shape2.n1]),e.uniform2fv(l.uniforms.n2,[n.shape1.n2,n.shape2.n2]),e.uniform2fv(l.uniforms.n3,[n.shape1.n3,n.shape2.n3]),e.uniform2fv(l.uniforms.scale,[n.shape1.Scale,n.shape2.Scale]),e.uniform1f(l.uniforms.pointSize,n.rendering["Point size"]),e.uniform1f(l.uniforms.shapeAMorph,n.morph["Shape A morph"]),e.uniform1f(l.uniforms.shapeBMorph,n.morph["Shape B morph"]),e.uniform1f(l.uniforms.shapeMorph,n.morph["Shape morph"]),e.uniform1f(l.uniforms.typeMorph,n.morph["Type morph"])}),v=0;!function b(){var t=g.rendering["Draw mode"],n=g.rendering["Auto-rotate"];e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var r=e.viewportWidth/e.viewportHeight;d.mat4.perspective(_,45,r,.1,100),d.mat4.identity(m),d.mat4.translate(m,m,[0,0,-2]),d.mat4.rotate(m,m,v,[0,1,0]),n&&(v+=.005),e.uniformMatrix4fv(l.uniforms.projectionMatrix,!1,_),e.uniformMatrix4fv(l.uniforms.modelViewMatrix,!1,m),e.drawElements(t,p.index.numItems,e.UNSIGNED_SHORT,0),requestAnimationFrame(b)}()}var c=n(1),d=n(4),h=n(2),f=n(3);!function(){var t=document.createElement("canvas"),e=r(t);e?(document.body.appendChild(t),l(t,e)):document.getElementById("no-webgl").style.display="block"}()},function(t,e,n){t.exports=n(5),t.exports.color=n(6)},function(t){t.exports=function(){return["attribute vec2 position;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform vec2 m;","uniform vec2 n1;","uniform vec2 n2;","uniform vec2 n3;","uniform vec2 scale;","uniform float shapeAMorph;","uniform float shapeBMorph;","uniform float shapeMorph;","uniform float typeMorph;","uniform float pointSize;","varying vec3 vPosition;","float superformula (float phi, float m, float n1, float n2, float n3) {","  m = max(m, 1.0);","  n1 = max(n1, 1.0);","  n2 = max(n2, 1.0);","  n3 = max(n3, 1.0);","  float t1 = pow(abs(cos((m * phi) / 4.0)), n2);","  float t2 = pow(abs(sin((m * phi) / 4.0)), n3);","  float result = pow(t1 + t2, 1.0 / n1);","  return 1.0 / result; // Divide by zero?","}","void main(void) {","  float phi = position.x;","  float theta = position.y;","  float shapeA = superformula(phi, m.x, n1.x, n2.x, n3.x) * scale.x;","  float shapeB = superformula(theta, m.y, n1.y, n2.y, n3.y) * scale.y;","  float shapeC = superformula(phi, m.y, n1.y, n2.y, n3.y) * scale.y;","  float shapeD = superformula(theta, m.x, n1.x, n2.x, n3.x) * scale.x;","  float st = sin(theta);","  float sp = sin(phi);","  float ct = cos(theta);","  float cp = cos(phi);","  vec3 mode1 = vec3(shapeA * ct * shapeB * cp,","                    shapeA * st * shapeB * cp, shapeB * sp);","  vec3 mode2 = vec3(shapeA * ct * shapeA * cp,","                    shapeA * st * shapeA * cp, shapeA * sp);","  vec3 mode3 = vec3(shapeB * ct * shapeB * cp,","                    shapeB * st * shapeB * cp, shapeB * sp);","  vec3 mode4 = vec3(shapeC * ct * shapeC * cp,","                    shapeC * st * shapeC * cp, shapeC * sp);","  vec3 mode5 = vec3(shapeD * ct * shapeD * cp,","                    shapeD * st * shapeD * cp, shapeD * sp);","  vec3 shapeAPos = mix(mode2, mode5, shapeAMorph);","  vec3 shapeBPos = mix(mode3, mode4, shapeBMorph);","  vec3 singlePos = mix(shapeAPos, shapeBPos, shapeMorph);","  vec3 position = mix(singlePos, mode1, typeMorph);","  gl_PointSize = pointSize;","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vPosition = normalize(position.xyz);","}",""].join("\n")}},function(t){t.exports=function(){return["precision mediump float;","varying vec3 vPosition;","void main(void) {","  gl_FragColor = vec4(sin(vPosition.z),","                      cos(vPosition.y),","                      cos(vPosition.x), 1.0);","}",""].join("\n")}},function(t,e){!function(){"use strict";var t={};t.exports=e,function(t){if(!e)var e=1e-6;if(!n)var n="undefined"!=typeof Float32Array?Float32Array:Array;var r={};r.setMatrixArrayType=function(t){n=t},"undefined"!=typeof t&&(t.glMatrix=r);var o={};o.create=function(){var t=new n(2);return t[0]=0,t[1]=0,t},o.clone=function(t){var e=new n(2);return e[0]=t[0],e[1]=t[1],e},o.fromValues=function(t,e){var r=new n(2);return r[0]=t,r[1]=e,r},o.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},o.set=function(t,e,n){return t[0]=e,t[1]=n,t},o.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},o.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t},o.sub=o.subtract,o.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t},o.mul=o.multiply,o.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t},o.div=o.divide,o.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},o.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},o.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},o.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},o.dist=o.distance,o.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r},o.sqrDist=o.squaredDistance,o.length=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)},o.len=o.length,o.squaredLength=function(t){var e=t[0],n=t[1];return e*e+n*n},o.sqrLen=o.squaredLength,o.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},o.normalize=function(t,e){var n=e[0],r=e[1],o=n*n+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o),t},o.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},o.cross=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t},o.lerp=function(t,e,n,r){var o=e[0],i=e[1];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t},o.transformMat2=function(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[2]*o,t[1]=n[1]*r+n[3]*o,t},o.transformMat2d=function(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[2]*o+n[4],t[1]=n[1]*r+n[3]*o+n[5],t},o.transformMat3=function(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[3]*o+n[6],t[1]=n[1]*r+n[4]*o+n[7],t},o.transformMat4=function(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[4]*o+n[12],t[1]=n[1]*r+n[5]*o+n[13],t},o.forEach=function(){var t=o.create();return function(e,n,r,o,i,a){var s,u;for(n||(n=2),r||(r=0),u=o?Math.min(o*n+r,e.length):e.length,s=r;u>s;s+=n)t[0]=e[s],t[1]=e[s+1],i(t,t,a),e[s]=t[0],e[s+1]=t[1];return e}}(),o.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},"undefined"!=typeof t&&(t.vec2=o);var i={};i.create=function(){var t=new n(3);return t[0]=0,t[1]=0,t[2]=0,t},i.clone=function(t){var e=new n(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},i.fromValues=function(t,e,r){var o=new n(3);return o[0]=t,o[1]=e,o[2]=r,o},i.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},i.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},i.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},i.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},i.sub=i.subtract,i.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},i.mul=i.multiply,i.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},i.div=i.divide,i.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},i.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},i.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},i.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return Math.sqrt(n*n+r*r+o*o)},i.dist=i.distance,i.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return n*n+r*r+o*o},i.sqrDist=i.squaredDistance,i.length=function(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)},i.len=i.length,i.squaredLength=function(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r},i.sqrLen=i.squaredLength,i.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},i.normalize=function(t,e){var n=e[0],r=e[1],o=e[2],i=n*n+r*r+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i),t},i.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},i.cross=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[0],s=n[1],u=n[2];return t[0]=o*u-i*s,t[1]=i*a-r*u,t[2]=r*s-o*a,t},i.lerp=function(t,e,n,r){var o=e[0],i=e[1],a=e[2];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t[2]=a+r*(n[2]-a),t},i.transformMat4=function(t,e,n){var r=e[0],o=e[1],i=e[2];return t[0]=n[0]*r+n[4]*o+n[8]*i+n[12],t[1]=n[1]*r+n[5]*o+n[9]*i+n[13],t[2]=n[2]*r+n[6]*o+n[10]*i+n[14],t},i.transformQuat=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[0],s=n[1],u=n[2],l=n[3],c=l*r+s*i-u*o,d=l*o+u*r-a*i,h=l*i+a*o-s*r,f=-a*r-s*o-u*i;return t[0]=c*l+f*-a+d*-u-h*-s,t[1]=d*l+f*-s+h*-a-c*-u,t[2]=h*l+f*-u+c*-s-d*-a,t},i.forEach=function(){var t=i.create();return function(e,n,r,o,i,a){var s,u;for(n||(n=3),r||(r=0),u=o?Math.min(o*n+r,e.length):e.length,s=r;u>s;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],i(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}(),i.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},"undefined"!=typeof t&&(t.vec3=i);var a={};a.create=function(){var t=new n(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},a.clone=function(t){var e=new n(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},a.fromValues=function(t,e,r,o){var i=new n(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=o,i},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},a.set=function(t,e,n,r,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=o,t},a.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},a.subtract=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t},a.sub=a.subtract,a.multiply=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t},a.mul=a.multiply,a.divide=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t},a.div=a.divide,a.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},a.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},a.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},a.distance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2],i=e[3]-t[3];return Math.sqrt(n*n+r*r+o*o+i*i)},a.dist=a.distance,a.squaredDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2],i=e[3]-t[3];return n*n+r*r+o*o+i*i},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],n=t[1],r=t[2],o=t[3];return Math.sqrt(e*e+n*n+r*r+o*o)},a.len=a.length,a.squaredLength=function(t){var e=t[0],n=t[1],r=t[2],o=t[3];return e*e+n*n+r*r+o*o},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},a.normalize=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n*n+r*r+o*o+i*i;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},a.lerp=function(t,e,n,r){var o=e[0],i=e[1],a=e[2],s=e[3];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t[2]=a+r*(n[2]-a),t[3]=s+r*(n[3]-s),t},a.transformMat4=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3];return t[0]=n[0]*r+n[4]*o+n[8]*i+n[12]*a,t[1]=n[1]*r+n[5]*o+n[9]*i+n[13]*a,t[2]=n[2]*r+n[6]*o+n[10]*i+n[14]*a,t[3]=n[3]*r+n[7]*o+n[11]*i+n[15]*a,t},a.transformQuat=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[0],s=n[1],u=n[2],l=n[3],c=l*r+s*i-u*o,d=l*o+u*r-a*i,h=l*i+a*o-s*r,f=-a*r-s*o-u*i;return t[0]=c*l+f*-a+d*-u-h*-s,t[1]=d*l+f*-s+h*-a-c*-u,t[2]=h*l+f*-u+c*-s-d*-a,t},a.forEach=function(){var t=a.create();return function(e,n,r,o,i,a){var s,u;for(n||(n=4),r||(r=0),u=o?Math.min(o*n+r,e.length):e.length,s=r;u>s;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],i(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}(),a.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.vec4=a);{var s={};new Float32Array([1,0,0,1])}s.create=function(){var t=new n(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},s.clone=function(t){var e=new n(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},s.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},s.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},s.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},s.invert=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n*i-o*r;return a?(a=1/a,t[0]=i*a,t[1]=-r*a,t[2]=-o*a,t[3]=n*a,t):null},s.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},s.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},s.multiply=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=n[0],u=n[1],l=n[2],c=n[3];return t[0]=r*s+o*l,t[1]=r*u+o*c,t[2]=i*s+a*l,t[3]=i*u+a*c,t},s.mul=s.multiply,s.rotate=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=r*-s+o*u,t[2]=i*u+a*s,t[3]=i*-s+a*u,t},s.scale=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=n[0],u=n[1];return t[0]=r*s,t[1]=o*u,t[2]=i*s,t[3]=a*u,t},s.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.mat2=s);{var u={};new Float32Array([1,0,0,1,0,0])}u.create=function(){var t=new n(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},u.clone=function(t){var e=new n(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},u.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},u.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},u.invert=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],s=e[5],u=n*i-r*o;return u?(u=1/u,t[0]=i*u,t[1]=-r*u,t[2]=-o*u,t[3]=n*u,t[4]=(o*s-i*a)*u,t[5]=(r*a-n*s)*u,t):null},u.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},u.multiply=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],l=n[0],c=n[1],d=n[2],h=n[3],f=n[4],p=n[5];return t[0]=r*l+o*d,t[1]=r*c+o*h,t[2]=i*l+a*d,t[3]=i*c+a*h,t[4]=l*s+d*u+f,t[5]=c*s+h*u+p,t},u.mul=u.multiply,u.rotate=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],l=Math.sin(n),c=Math.cos(n);return t[0]=r*c+o*l,t[1]=-r*l+o*c,t[2]=i*c+a*l,t[3]=-i*l+c*a,t[4]=c*s+l*u,t[5]=c*u-l*s,t},u.scale=function(t,e,n){var r=n[0],o=n[1];return t[0]=e[0]*r,t[1]=e[1]*o,t[2]=e[2]*r,t[3]=e[3]*o,t[4]=e[4]*r,t[5]=e[5]*o,t},u.translate=function(t,e,n){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+n[0],t[5]=e[5]+n[1],t},u.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},"undefined"!=typeof t&&(t.mat2d=u);{var l={};new Float32Array([1,0,0,0,1,0,0,0,1])}l.create=function(){var t=new n(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},l.clone=function(t){var e=new n(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},l.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},l.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},l.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],o=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=o}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},l.invert=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],d=c*a-s*l,h=-c*i+s*u,f=l*i-a*u,p=n*d+r*h+o*f;return p?(p=1/p,t[0]=d*p,t[1]=(-c*r+o*l)*p,t[2]=(s*r-o*a)*p,t[3]=h*p,t[4]=(c*n-o*u)*p,t[5]=(-s*n+o*i)*p,t[6]=f*p,t[7]=(-l*n+r*u)*p,t[8]=(a*n-r*i)*p,t):null},l.adjoint=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8];return t[0]=a*c-s*l,t[1]=o*l-r*c,t[2]=r*s-o*a,t[3]=s*u-i*c,t[4]=n*c-o*u,t[5]=o*i-n*s,t[6]=i*l-a*u,t[7]=r*u-n*l,t[8]=n*a-r*i,t},l.determinant=function(t){var e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],a=t[5],s=t[6],u=t[7],l=t[8];return e*(l*i-a*u)+n*(-l*o+a*s)+r*(u*o-i*s)},l.multiply=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],d=e[8],h=n[0],f=n[1],p=n[2],m=n[3],_=n[4],g=n[5],v=n[6],b=n[7],y=n[8];return t[0]=h*r+f*a+p*l,t[1]=h*o+f*s+p*c,t[2]=h*i+f*u+p*d,t[3]=m*r+_*a+g*l,t[4]=m*o+_*s+g*c,t[5]=m*i+_*u+g*d,t[6]=v*r+b*a+y*l,t[7]=v*o+b*s+y*c,t[8]=v*i+b*u+y*d,t},l.mul=l.multiply,l.translate=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],d=e[8],h=n[0],f=n[1];return t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=s,t[5]=u,t[6]=h*r+f*a+l,t[7]=h*o+f*s+c,t[8]=h*i+f*u+d,t},l.rotate=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],d=e[8],h=Math.sin(n),f=Math.cos(n);return t[0]=f*r+h*a,t[1]=f*o+h*s,t[2]=f*i+h*u,t[3]=f*a-h*r,t[4]=f*s-h*o,t[5]=f*u-h*i,t[6]=l,t[7]=c,t[8]=d,t},l.scale=function(t,e,n){var r=n[0],o=n[2];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=o*e[3],t[4]=o*e[4],t[5]=o*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},l.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},l.fromQuat=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n+n,s=r+r,u=o+o,l=n*a,c=n*s,d=n*u,h=r*s,f=r*u,p=o*u,m=i*a,_=i*s,g=i*u;return t[0]=1-(h+p),t[1]=c+g,t[2]=d-_,t[3]=c-g,t[4]=1-(l+p),t[5]=f+m,t[6]=d+_,t[7]=f-m,t[8]=1-(l+h),t},l.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},"undefined"!=typeof t&&(t.mat3=l);{var c={};new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}c.create=function(){var t=new n(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},c.clone=function(t){var e=new n(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},c.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},c.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},c.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],o=e[3],i=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=i,t[11]=e[14],t[12]=o,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},c.invert=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],d=e[9],h=e[10],f=e[11],p=e[12],m=e[13],_=e[14],g=e[15],v=n*s-r*a,b=n*u-o*a,y=n*l-i*a,x=r*u-o*s,w=r*l-i*s,A=o*l-i*u,E=c*m-d*p,C=c*_-h*p,S=c*g-f*p,M=d*_-h*m,k=d*g-f*m,B=h*g-f*_,L=v*B-b*k+y*M+x*S-w*C+A*E;return L?(L=1/L,t[0]=(s*B-u*k+l*M)*L,t[1]=(o*k-r*B-i*M)*L,t[2]=(m*A-_*w+g*x)*L,t[3]=(h*w-d*A-f*x)*L,t[4]=(u*S-a*B-l*C)*L,t[5]=(n*B-o*S+i*C)*L,t[6]=(_*y-p*A-g*b)*L,t[7]=(c*A-h*y+f*b)*L,t[8]=(a*k-s*S+l*E)*L,t[9]=(r*S-n*k-i*E)*L,t[10]=(p*w-m*y+g*v)*L,t[11]=(d*y-c*w-f*v)*L,t[12]=(s*C-a*M-u*E)*L,t[13]=(n*M-r*C+o*E)*L,t[14]=(m*b-p*x-_*v)*L,t[15]=(c*x-d*b+h*v)*L,t):null},c.adjoint=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=e[4],s=e[5],u=e[6],l=e[7],c=e[8],d=e[9],h=e[10],f=e[11],p=e[12],m=e[13],_=e[14],g=e[15];return t[0]=s*(h*g-f*_)-d*(u*g-l*_)+m*(u*f-l*h),t[1]=-(r*(h*g-f*_)-d*(o*g-i*_)+m*(o*f-i*h)),t[2]=r*(u*g-l*_)-s*(o*g-i*_)+m*(o*l-i*u),t[3]=-(r*(u*f-l*h)-s*(o*f-i*h)+d*(o*l-i*u)),t[4]=-(a*(h*g-f*_)-c*(u*g-l*_)+p*(u*f-l*h)),t[5]=n*(h*g-f*_)-c*(o*g-i*_)+p*(o*f-i*h),t[6]=-(n*(u*g-l*_)-a*(o*g-i*_)+p*(o*l-i*u)),t[7]=n*(u*f-l*h)-a*(o*f-i*h)+c*(o*l-i*u),t[8]=a*(d*g-f*m)-c*(s*g-l*m)+p*(s*f-l*d),t[9]=-(n*(d*g-f*m)-c*(r*g-i*m)+p*(r*f-i*d)),t[10]=n*(s*g-l*m)-a*(r*g-i*m)+p*(r*l-i*s),t[11]=-(n*(s*f-l*d)-a*(r*f-i*d)+c*(r*l-i*s)),t[12]=-(a*(d*_-h*m)-c*(s*_-u*m)+p*(s*h-u*d)),t[13]=n*(d*_-h*m)-c*(r*_-o*m)+p*(r*h-o*d),t[14]=-(n*(s*_-u*m)-a*(r*_-o*m)+p*(r*u-o*s)),t[15]=n*(s*h-u*d)-a*(r*h-o*d)+c*(r*u-o*s),t},c.determinant=function(t){var e=t[0],n=t[1],r=t[2],o=t[3],i=t[4],a=t[5],s=t[6],u=t[7],l=t[8],c=t[9],d=t[10],h=t[11],f=t[12],p=t[13],m=t[14],_=t[15],g=e*a-n*i,v=e*s-r*i,b=e*u-o*i,y=n*s-r*a,x=n*u-o*a,w=r*u-o*s,A=l*p-c*f,E=l*m-d*f,C=l*_-h*f,S=c*m-d*p,M=c*_-h*p,k=d*_-h*m;return g*k-v*M+b*S+y*C-x*E+w*A},c.multiply=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],d=e[8],h=e[9],f=e[10],p=e[11],m=e[12],_=e[13],g=e[14],v=e[15],b=n[0],y=n[1],x=n[2],w=n[3];return t[0]=b*r+y*s+x*d+w*m,t[1]=b*o+y*u+x*h+w*_,t[2]=b*i+y*l+x*f+w*g,t[3]=b*a+y*c+x*p+w*v,b=n[4],y=n[5],x=n[6],w=n[7],t[4]=b*r+y*s+x*d+w*m,t[5]=b*o+y*u+x*h+w*_,t[6]=b*i+y*l+x*f+w*g,t[7]=b*a+y*c+x*p+w*v,b=n[8],y=n[9],x=n[10],w=n[11],t[8]=b*r+y*s+x*d+w*m,t[9]=b*o+y*u+x*h+w*_,t[10]=b*i+y*l+x*f+w*g,t[11]=b*a+y*c+x*p+w*v,b=n[12],y=n[13],x=n[14],w=n[15],t[12]=b*r+y*s+x*d+w*m,t[13]=b*o+y*u+x*h+w*_,t[14]=b*i+y*l+x*f+w*g,t[15]=b*a+y*c+x*p+w*v,t},c.mul=c.multiply,c.translate=function(t,e,n){var r,o,i,a,s,u,l,c,d,h,f,p,m=n[0],_=n[1],g=n[2];return e===t?(t[12]=e[0]*m+e[4]*_+e[8]*g+e[12],t[13]=e[1]*m+e[5]*_+e[9]*g+e[13],t[14]=e[2]*m+e[6]*_+e[10]*g+e[14],t[15]=e[3]*m+e[7]*_+e[11]*g+e[15]):(r=e[0],o=e[1],i=e[2],a=e[3],s=e[4],u=e[5],l=e[6],c=e[7],d=e[8],h=e[9],f=e[10],p=e[11],t[0]=r,t[1]=o,t[2]=i,t[3]=a,t[4]=s,t[5]=u,t[6]=l,t[7]=c,t[8]=d,t[9]=h,t[10]=f,t[11]=p,t[12]=r*m+s*_+d*g+e[12],t[13]=o*m+u*_+h*g+e[13],t[14]=i*m+l*_+f*g+e[14],t[15]=a*m+c*_+p*g+e[15]),t},c.scale=function(t,e,n){var r=n[0],o=n[1],i=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},c.rotate=function(t,n,r,o){var i,a,s,u,l,c,d,h,f,p,m,_,g,v,b,y,x,w,A,E,C,S,M,k,B=o[0],L=o[1],R=o[2],N=Math.sqrt(B*B+L*L+R*R);return Math.abs(N)<e?null:(N=1/N,B*=N,L*=N,R*=N,i=Math.sin(r),a=Math.cos(r),s=1-a,u=n[0],l=n[1],c=n[2],d=n[3],h=n[4],f=n[5],p=n[6],m=n[7],_=n[8],g=n[9],v=n[10],b=n[11],y=B*B*s+a,x=L*B*s+R*i,w=R*B*s-L*i,A=B*L*s-R*i,E=L*L*s+a,C=R*L*s+B*i,S=B*R*s+L*i,M=L*R*s-B*i,k=R*R*s+a,t[0]=u*y+h*x+_*w,t[1]=l*y+f*x+g*w,t[2]=c*y+p*x+v*w,t[3]=d*y+m*x+b*w,t[4]=u*A+h*E+_*C,t[5]=l*A+f*E+g*C,t[6]=c*A+p*E+v*C,t[7]=d*A+m*E+b*C,t[8]=u*S+h*M+_*k,t[9]=l*S+f*M+g*k,t[10]=c*S+p*M+v*k,t[11]=d*S+m*M+b*k,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)},c.rotateX=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[4],a=e[5],s=e[6],u=e[7],l=e[8],c=e[9],d=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*o+l*r,t[5]=a*o+c*r,t[6]=s*o+d*r,t[7]=u*o+h*r,t[8]=l*o-i*r,t[9]=c*o-a*r,t[10]=d*o-s*r,t[11]=h*o-u*r,t},c.rotateY=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[0],a=e[1],s=e[2],u=e[3],l=e[8],c=e[9],d=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*o-l*r,t[1]=a*o-c*r,t[2]=s*o-d*r,t[3]=u*o-h*r,t[8]=i*r+l*o,t[9]=a*r+c*o,t[10]=s*r+d*o,t[11]=u*r+h*o,t},c.rotateZ=function(t,e,n){var r=Math.sin(n),o=Math.cos(n),i=e[0],a=e[1],s=e[2],u=e[3],l=e[4],c=e[5],d=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*o+l*r,t[1]=a*o+c*r,t[2]=s*o+d*r,t[3]=u*o+h*r,t[4]=l*o-i*r,t[5]=c*o-a*r,t[6]=d*o-s*r,t[7]=h*o-u*r,t},c.fromRotationTranslation=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=r+r,u=o+o,l=i+i,c=r*s,d=r*u,h=r*l,f=o*u,p=o*l,m=i*l,_=a*s,g=a*u,v=a*l;return t[0]=1-(f+m),t[1]=d+v,t[2]=h-g,t[3]=0,t[4]=d-v,t[5]=1-(c+m),t[6]=p+_,t[7]=0,t[8]=h+g,t[9]=p-_,t[10]=1-(c+f),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},c.fromQuat=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n+n,s=r+r,u=o+o,l=n*a,c=n*s,d=n*u,h=r*s,f=r*u,p=o*u,m=i*a,_=i*s,g=i*u;return t[0]=1-(h+p),t[1]=c+g,t[2]=d-_,t[3]=0,t[4]=c-g,t[5]=1-(l+p),t[6]=f+m,t[7]=0,t[8]=d+_,t[9]=f-m,t[10]=1-(l+h),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},c.frustum=function(t,e,n,r,o,i,a){var s=1/(n-e),u=1/(o-r),l=1/(i-a);return t[0]=2*i*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(o+r)*u,t[10]=(a+i)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*i*2*l,t[15]=0,t},c.perspective=function(t,e,n,r,o){var i=1/Math.tan(e/2),a=1/(r-o);return t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(o+r)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*o*r*a,t[15]=0,t},c.ortho=function(t,e,n,r,o,i,a){var s=1/(e-n),u=1/(r-o),l=1/(i-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+n)*s,t[13]=(o+r)*u,t[14]=(a+i)*l,t[15]=1,t},c.lookAt=function(t,n,r,o){var i,a,s,u,l,d,h,f,p,m,_=n[0],g=n[1],v=n[2],b=o[0],y=o[1],x=o[2],w=r[0],A=r[1],E=r[2];return Math.abs(_-w)<e&&Math.abs(g-A)<e&&Math.abs(v-E)<e?c.identity(t):(h=_-w,f=g-A,p=v-E,m=1/Math.sqrt(h*h+f*f+p*p),h*=m,f*=m,p*=m,i=y*p-x*f,a=x*h-b*p,s=b*f-y*h,m=Math.sqrt(i*i+a*a+s*s),m?(m=1/m,i*=m,a*=m,s*=m):(i=0,a=0,s=0),u=f*s-p*a,l=p*i-h*s,d=h*a-f*i,m=Math.sqrt(u*u+l*l+d*d),m?(m=1/m,u*=m,l*=m,d*=m):(u=0,l=0,d=0),t[0]=i,t[1]=u,t[2]=h,t[3]=0,t[4]=a,t[5]=l,t[6]=f,t[7]=0,t[8]=s,t[9]=d,t[10]=p,t[11]=0,t[12]=-(i*_+a*g+s*v),t[13]=-(u*_+l*g+d*v),t[14]=-(h*_+f*g+p*v),t[15]=1,t)},c.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},"undefined"!=typeof t&&(t.mat4=c);{var d={};new Float32Array([0,0,0,1])}d.create=function(){var t=new n(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},d.clone=a.clone,d.fromValues=a.fromValues,d.copy=a.copy,d.set=a.set,d.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},d.setAxisAngle=function(t,e,n){n=.5*n;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t},d.add=a.add,d.multiply=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=n[0],u=n[1],l=n[2],c=n[3];return t[0]=r*c+a*s+o*l-i*u,t[1]=o*c+a*u+i*s-r*l,t[2]=i*c+a*l+r*u-o*s,t[3]=a*c-r*s-o*u-i*l,t},d.mul=d.multiply,d.scale=a.scale,d.rotateX=function(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*s,t[1]=o*u+i*s,t[2]=i*u-o*s,t[3]=a*u-r*s,t},d.rotateY=function(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u-i*s,t[1]=o*u+a*s,t[2]=i*u+r*s,t[3]=a*u-o*s,t},d.rotateZ=function(t,e,n){n*=.5;var r=e[0],o=e[1],i=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+o*s,t[1]=o*u-r*s,t[2]=i*u+a*s,t[3]=a*u-i*s,t},d.calculateW=function(t,e){var n=e[0],r=e[1],o=e[2];return t[0]=n,t[1]=r,t[2]=o,t[3]=-Math.sqrt(Math.abs(1-n*n-r*r-o*o)),t},d.dot=a.dot,d.lerp=a.lerp,d.slerp=function(t,e,n,r){var o,i,a,s,u=e[0],l=e[1],c=e[2],d=e[3],h=n[0],f=n[1],p=n[2],m=n[3],_=u*h+l*f+c*p+d*m;return Math.abs(_)>=1?(t!==e&&(t[0]=u,t[1]=l,t[2]=c,t[3]=d),t):(o=Math.acos(_),i=Math.sqrt(1-_*_),Math.abs(i)<.001?(t[0]=.5*u+.5*h,t[1]=.5*l+.5*f,t[2]=.5*c+.5*p,t[3]=.5*d+.5*m,t):(a=Math.sin((1-r)*o)/i,s=Math.sin(r*o)/i,t[0]=u*a+h*s,t[1]=l*a+f*s,t[2]=c*a+p*s,t[3]=d*a+m*s,t))},d.invert=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n*n+r*r+o*o+i*i,s=a?1/a:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-o*s,t[3]=i*s,t},d.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},d.length=a.length,d.len=d.length,d.squaredLength=a.squaredLength,d.sqrLen=d.squaredLength,d.normalize=a.normalize,d.fromMat3=function(){var t=[1,2,0];return function(e,n){var r,o=n[0]+n[4]+n[8];if(o>0)r=Math.sqrt(o+1),e[3]=.5*r,r=.5/r,e[0]=(n[7]-n[5])*r,e[1]=(n[2]-n[6])*r,e[2]=(n[3]-n[1])*r;else{var i=0;n[4]>n[0]&&(i=1),n[8]>n[3*i+i]&&(i=2);var a=t[i],s=t[a];r=Math.sqrt(n[3*i+i]-n[3*a+a]-n[3*s+s]+1),e[i]=.5*r,r=.5/r,e[3]=(n[3*s+a]-n[3*a+s])*r,e[a]=(n[3*a+i]+n[3*i+a])*r,e[s]=(n[3*s+i]+n[3*i+s])*r
}return e}}(),d.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.quat=d)}(t.exports)}()},function(t){var e=t.exports=e||{};e.gui=e.gui||{},e.utils=e.utils||{},e.controllers=e.controllers||{},e.dom=e.dom||{},e.color=e.color||{},e.utils.css=function(){return{load:function(t,e){e=e||document;var n=e.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=t,e.getElementsByTagName("head")[0].appendChild(n)},inject:function(t,e){e=e||document;var n=document.createElement("style");n.type="text/css",n.innerHTML=t,e.getElementsByTagName("head")[0].appendChild(n)}}}(),e.utils.common=function(){var t=Array.prototype.forEach,e=Array.prototype.slice;return{BREAK:{},extend:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(e[n])||(t[n]=e[n])},this),t},defaults:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(t[n])&&(t[n]=e[n])},this),t},compose:function(){var t=e.call(arguments);return function(){for(var n=e.call(arguments),r=t.length-1;r>=0;r--)n=[t[r].apply(this,n)];return n[0]}},each:function(e,n,r){if(t&&e.forEach===t)e.forEach(n,r);else if(e.length===e.length+0){for(var o=0,i=e.length;i>o;o++)if(o in e&&n.call(r,e[o],o)===this.BREAK)return}else for(var o in e)if(n.call(r,e[o],o)===this.BREAK)return},defer:function(t){setTimeout(t,0)},toArray:function(t){return t.toArray?t.toArray():e.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){return t!==t},isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return t===!1||t===!0},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}}}(),e.controllers.Controller=function(t){var e=function(t,e){this.initialValue=t[e],this.domElement=document.createElement("div"),this.object=t,this.property=e,this.__onChange=void 0,this.__onFinishChange=void 0};return t.extend(e.prototype,{onChange:function(t){return this.__onChange=t,this},onFinishChange:function(t){return this.__onFinishChange=t,this},setValue:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),e}(e.utils.common),e.dom.dom=function(t){function e(e){if("0"===e||t.isUndefined(e))return 0;var n=e.match(o);return t.isNull(n)?0:parseFloat(n[1])}var n={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},r={};t.each(n,function(e,n){t.each(e,function(t){r[t]=n})});var o=/(\d+(\.\d+)?)px/,i={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(e,n,r){t.isUndefined(n)&&(n=!0),t.isUndefined(r)&&(r=!0),e.style.position="absolute",n&&(e.style.left=0,e.style.right=0),r&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,n,o,i){o=o||{};var a=r[n];if(!a)throw new Error("Event type "+n+" not supported.");var s=document.createEvent(a);switch(a){case"MouseEvents":var u=o.x||o.clientX||0,l=o.y||o.clientY||0;s.initMouseEvent(n,o.bubbles||!1,o.cancelable||!0,window,o.clickCount||1,0,0,u,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=s.initKeyboardEvent||s.initKeyEvent;t.defaults(o,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(n,o.bubbles||!1,o.cancelable,window,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.keyCode,o.charCode);break;default:s.initEvent(n,o.bubbles||!1,o.cancelable||!0)}t.defaults(s,i),e.dispatchEvent(s)},bind:function(t,e,n,r){return r=r||!1,t.addEventListener?t.addEventListener(e,n,r):t.attachEvent&&t.attachEvent("on"+e,n),i},unbind:function(t,e,n,r){return r=r||!1,t.removeEventListener?t.removeEventListener(e,n,r):t.detachEvent&&t.detachEvent("on"+e,n),i},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var n=t.className.split(/ +/);-1==n.indexOf(e)&&(n.push(e),t.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return i},removeClass:function(t,e){if(e)if(void 0===t.className);else if(t.className===e)t.removeAttribute("class");else{var n=t.className.split(/ +/),r=n.indexOf(e);-1!=r&&(n.splice(r,1),t.className=n.join(" "))}else t.className=void 0;return i},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var n=getComputedStyle(t);return e(n["border-left-width"])+e(n["border-right-width"])+e(n["padding-left"])+e(n["padding-right"])+e(n.width)},getHeight:function(t){var n=getComputedStyle(t);return e(n["border-top-width"])+e(n["border-bottom-width"])+e(n["padding-top"])+e(n["padding-bottom"])+e(n.height)},getOffset:function(t){var e={left:0,top:0};if(t.offsetParent)do e.left+=t.offsetLeft,e.top+=t.offsetTop;while(t=t.offsetParent);return e},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}};return i}(e.utils.common),e.controllers.OptionController=function(t,e,n){var r=function(t,o,i){r.superclass.call(this,t,o);var a=this;if(this.__select=document.createElement("select"),n.isArray(i)){var s={};n.each(i,function(t){s[t]=t}),i=s}n.each(i,function(t,e){var n=document.createElement("option");n.innerHTML=e,n.setAttribute("value",t),a.__select.appendChild(n)}),this.updateDisplay(),e.bind(this.__select,"change",function(){var t=this.options[this.selectedIndex].value;a.setValue(t)}),this.domElement.appendChild(this.__select)};return r.superclass=t,n.extend(r.prototype,t.prototype,{setValue:function(t){var e=r.superclass.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e},updateDisplay:function(){return this.__select.value=this.getValue(),r.superclass.prototype.updateDisplay.call(this)}}),r}(e.controllers.Controller,e.dom.dom,e.utils.common),e.controllers.NumberController=function(t,e){function n(t){return t=t.toString(),t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var r=function(t,o,i){r.superclass.call(this,t,o),i=i||{},this.__min=i.min,this.__max=i.max,this.__step=i.step,this.__impliedStep=e.isUndefined(this.__step)?0==this.initialValue?1:Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__step,this.__precision=n(this.__impliedStep)};return r.superclass=t,e.extend(r.prototype,t.prototype,{setValue:function(t){return void 0!==this.__min&&t<this.__min?t=this.__min:void 0!==this.__max&&t>this.__max&&(t=this.__max),void 0!==this.__step&&t%this.__step!=0&&(t=Math.round(t/this.__step)*this.__step),r.superclass.prototype.setValue.call(this,t)},min:function(t){return this.__min=t,this},max:function(t){return this.__max=t,this},step:function(t){return this.__step=t,this}}),r}(e.controllers.Controller,e.utils.common),e.controllers.NumberControllerBox=function(t,e,n){function r(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}var o=function(t,r,i){function a(){var t=parseFloat(h.__input.value);n.isNaN(t)||h.setValue(t)}function s(){a(),h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}function u(t){e.bind(window,"mousemove",l),e.bind(window,"mouseup",c),d=t.clientY}function l(t){var e=d-t.clientY;h.setValue(h.getValue()+e*h.__impliedStep),d=t.clientY}function c(){e.unbind(window,"mousemove",l),e.unbind(window,"mouseup",c)}this.__truncationSuspended=!1,o.superclass.call(this,t,r,i);var d,h=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),e.bind(this.__input,"change",a),e.bind(this.__input,"blur",s),e.bind(this.__input,"mousedown",u),e.bind(this.__input,"keydown",function(t){13===t.keyCode&&(h.__truncationSuspended=!0,this.blur(),h.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return o.superclass=t,n.extend(o.prototype,t.prototype,{updateDisplay:function(){return this.__input.value=this.__truncationSuspended?this.getValue():r(this.getValue(),this.__precision),o.superclass.prototype.updateDisplay.call(this)}}),o}(e.controllers.NumberController,e.dom.dom,e.utils.common),e.controllers.NumberControllerSlider=function(t,e,n,r,o){function i(t,e,n,r,o){return r+(o-r)*((t-e)/(n-e))}var a=function(t,n,r,o,s){function u(t){e.bind(window,"mousemove",l),e.bind(window,"mouseup",c),l(t)}function l(t){t.preventDefault();var n=e.getOffset(d.__background),r=e.getWidth(d.__background);return d.setValue(i(t.clientX,n.left,n.left+r,d.__min,d.__max)),!1}function c(){e.unbind(window,"mousemove",l),e.unbind(window,"mouseup",c),d.__onFinishChange&&d.__onFinishChange.call(d,d.getValue())}a.superclass.call(this,t,n,{min:r,max:o,step:s});var d=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),e.bind(this.__background,"mousedown",u),e.addClass(this.__background,"slider"),e.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return a.superclass=t,a.useDefaultStyles=function(){n.inject(o)},r.extend(a.prototype,t.prototype,{updateDisplay:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",a.superclass.prototype.updateDisplay.call(this)}}),a}(e.controllers.NumberController,e.dom.dom,e.utils.css,e.utils.common,".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}"),e.controllers.FunctionController=function(t,e,n){var r=function(t,n,o){r.superclass.call(this,t,n);var i=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===o?"Fire":o,e.bind(this.__button,"click",function(t){return t.preventDefault(),i.fire(),!1}),e.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return r.superclass=t,n.extend(r.prototype,t.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.getValue().call(this.object)}}),r}(e.controllers.Controller,e.dom.dom,e.utils.common),e.controllers.BooleanController=function(t,e,n){var r=function(t,n){function o(){i.setValue(!i.__prev)}r.superclass.call(this,t,n);var i=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),e.bind(this.__checkbox,"change",o,!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return r.superclass=t,n.extend(r.prototype,t.prototype,{setValue:function(t){var e=r.superclass.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e},updateDisplay:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,r.superclass.prototype.updateDisplay.call(this)}}),r}(e.controllers.Controller,e.dom.dom,e.utils.common),e.color.toString=function(t){return function(e){if(1==e.a||t.isUndefined(e.a)){for(var n=e.hex.toString(16);n.length<6;)n="0"+n;return"#"+n}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}}(e.utils.common),e.color.interpret=function(t,e){var n,r,o=function(){r=!1;var t=arguments.length>1?e.toArray(arguments):arguments[0];return e.each(i,function(o){return o.litmus(t)?(e.each(o.conversions,function(o,i){return n=o.read(t),r===!1&&n!==!1?(r=n,n.conversionName=i,n.conversion=o,e.BREAK):void 0}),e.BREAK):void 0}),r},i=[{litmus:e.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:t},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:t},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:t},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:t}}},{litmus:e.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:e.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:e.isObject,conversions:{RGBA_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)&&e.isNumber(t.a)?{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)?{space:"RGB",r:t.r,g:t.g,b:t.b}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)&&e.isNumber(t.a)?{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)?{space:"HSV",h:t.h,s:t.s,v:t.v}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}];return o}(e.color.toString,e.utils.common),e.GUI=e.gui.GUI=function(t,e,n,r,o,i,a,s,u,l,c,d,h,f,p){function m(t,e,n,i){if(void 0===e[n])throw new Error("Object "+e+' has no property "'+n+'"');var a;if(i.color)a=new c(e,n);else{var s=[e,n].concat(i.factoryArgs);a=r.apply(t,s)}i.before instanceof o&&(i.before=i.before.__li),v(t,a),f.addClass(a.domElement,"c");var u=document.createElement("span");f.addClass(u,"property-name"),u.innerHTML=a.property;var l=document.createElement("div");l.appendChild(u),l.appendChild(a.domElement);var d=_(t,l,i.before);return f.addClass(d,P.CLASS_CONTROLLER_ROW),f.addClass(d,typeof a.getValue()),g(t,d,a),t.__controllers.push(a),a}function _(t,e,n){var r=document.createElement("li");return e&&r.appendChild(e),n?t.__ul.insertBefore(r,params.before):t.__ul.appendChild(r),t.onResize(),r}function g(t,e,n){if(n.__li=e,n.__gui=t,p.extend(n,{options:function(e){return arguments.length>1?(n.remove(),m(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[p.toArray(arguments)]})):p.isArray(e)||p.isObject(e)?(n.remove(),m(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[e]})):void 0},name:function(t){return n.__li.firstElementChild.firstElementChild.innerHTML=t,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof u){var r=new s(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});p.each(["updateDisplay","onChange","onFinishChange"],function(t){var e=n[t],o=r[t];n[t]=r[t]=function(){var t=Array.prototype.slice.call(arguments);return e.apply(n,t),o.apply(r,t)}}),f.addClass(e,"has-slider"),n.domElement.insertBefore(r.domElement,n.domElement.firstElementChild)}else if(n instanceof s){var o=function(e){return p.isNumber(n.__min)&&p.isNumber(n.__max)?(n.remove(),m(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]})):e};n.min=p.compose(o,n.min),n.max=p.compose(o,n.max)}else n instanceof i?(f.bind(e,"click",function(){f.fakeEvent(n.__checkbox,"click")}),f.bind(n.__checkbox,"click",function(t){t.stopPropagation()})):n instanceof a?(f.bind(e,"click",function(){f.fakeEvent(n.__button,"click")}),f.bind(e,"mouseover",function(){f.addClass(n.__button,"hover")}),f.bind(e,"mouseout",function(){f.removeClass(n.__button,"hover")})):n instanceof c&&(f.addClass(e,"color"),n.updateDisplay=p.compose(function(t){return e.style.borderLeftColor=n.__color.toString(),t},n.updateDisplay),n.updateDisplay());n.setValue=p.compose(function(e){return t.getRoot().__preset_select&&n.isModified()&&S(t.getRoot(),!0),e},n.setValue)}function v(t,e){var n=t.getRoot(),r=n.__rememberedObjects.indexOf(e.object);if(-1!=r){var o=n.__rememberedObjectIndecesToControllers[r];if(void 0===o&&(o={},n.__rememberedObjectIndecesToControllers[r]=o),o[e.property]=e,n.load&&n.load.remembered){var i,a=n.load.remembered;if(a[t.preset])i=a[t.preset];else{if(!a[T])return;i=a[T]}if(i[r]&&void 0!==i[r][e.property]){var s=i[r][e.property];e.initialValue=s,e.setValue(s)}}}}function b(t,e){return document.location.href+"."+e}function y(t){function e(){l.style.display=t.useLocalStorage?"block":"none"}var n=t.__save_row=document.createElement("li");f.addClass(t.domElement,"has-save"),t.__ul.insertBefore(n,t.__ul.firstChild),f.addClass(n,"save-row");var r=document.createElement("span");r.innerHTML="&nbsp;",f.addClass(r,"button gears");var o=document.createElement("span");o.innerHTML="Save",f.addClass(o,"button"),f.addClass(o,"save");var i=document.createElement("span");i.innerHTML="New",f.addClass(i,"button"),f.addClass(i,"save-as");var a=document.createElement("span");a.innerHTML="Revert",f.addClass(a,"button"),f.addClass(a,"revert");var s=t.__preset_select=document.createElement("select");if(t.load&&t.load.remembered?p.each(t.load.remembered,function(e,n){E(t,n,n==t.preset)}):E(t,T,!1),f.bind(s,"change",function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value}),n.appendChild(s),n.appendChild(r),n.appendChild(o),n.appendChild(i),n.appendChild(a),O){var u=document.getElementById("dg-save-locally"),l=document.getElementById("dg-local-explain");u.style.display="block";var c=document.getElementById("dg-local-storage");"true"===localStorage.getItem(b(t,"isLocal"))&&c.setAttribute("checked","checked"),e(),f.bind(c,"change",function(){t.useLocalStorage=!t.useLocalStorage,e()})}var d=document.getElementById("dg-new-constructor");f.bind(d,"keydown",function(t){!t.metaKey||67!==t.which&&67!=t.keyCode||k.hide()}),f.bind(r,"click",function(){d.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),k.show(),d.focus(),d.select()}),f.bind(o,"click",function(){t.save()}),f.bind(i,"click",function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)}),f.bind(a,"click",function(){t.revert()})}function x(t){function e(e){return e.preventDefault(),o=e.clientX,f.addClass(t.__closeButton,P.CLASS_DRAG),f.bind(window,"mousemove",n),f.bind(window,"mouseup",r),!1}function n(e){return e.preventDefault(),t.width+=o-e.clientX,t.onResize(),o=e.clientX,!1}function r(){f.removeClass(t.__closeButton,P.CLASS_DRAG),f.unbind(window,"mousemove",n),f.unbind(window,"mouseup",r)}t.__resize_handle=document.createElement("div"),p.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var o;f.bind(t.__resize_handle,"mousedown",e),f.bind(t.__closeButton,"mousedown",e),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function w(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function A(t,e){var n={};return p.each(t.__rememberedObjects,function(r,o){var i={},a=t.__rememberedObjectIndecesToControllers[o];p.each(a,function(t,n){i[n]=e?t.initialValue:t.getValue()}),n[o]=i}),n}function E(t,e,n){var r=document.createElement("option");r.innerHTML=e,r.value=e,t.__preset_select.appendChild(r),n&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function C(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value==t.preset&&(t.__preset_select.selectedIndex=e)}function S(t,e){var n=t.__preset_select[t.__preset_select.selectedIndex];n.innerHTML=e?n.value+"*":n.value}function M(t){0!=t.length&&d(function(){M(t)}),p.each(t,function(t){t.updateDisplay()})}t.inject(n);var k,B,L="dg",R=72,N=20,T="Default",O=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}}(),F=!0,D=!1,H=[],P=function(t){function e(){localStorage.setItem(b(r,"gui"),JSON.stringify(r.getSaveObject()))}function n(){var t=r.getRoot();t.width+=1,p.defer(function(){t.width-=1})}var r=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),f.addClass(this.domElement,L),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],t=t||{},t=p.defaults(t,{autoPlace:!0,width:P.DEFAULT_WIDTH}),t=p.defaults(t,{resizable:t.autoPlace,hideable:t.autoPlace}),p.isUndefined(t.load)?t.load={preset:T}:t.preset&&(t.load.preset=t.preset),p.isUndefined(t.parent)&&t.hideable&&H.push(this),t.resizable=p.isUndefined(t.parent)&&t.resizable,t.autoPlace&&p.isUndefined(t.scrollable)&&(t.scrollable=!0);var o=O&&"true"===localStorage.getItem(b(this,"isLocal"));if(Object.defineProperties(this,{parent:{get:function(){return t.parent}},scrollable:{get:function(){return t.scrollable}},autoPlace:{get:function(){return t.autoPlace}},preset:{get:function(){return r.parent?r.getRoot().preset:t.load.preset},set:function(e){r.parent?r.getRoot().preset=e:t.load.preset=e,C(this),r.revert()}},width:{get:function(){return t.width},set:function(e){t.width=e,w(r,e)}},name:{get:function(){return t.name},set:function(e){t.name=e,a&&(a.innerHTML=t.name)}},closed:{get:function(){return t.closed},set:function(e){t.closed=e,t.closed?f.addClass(r.__ul,P.CLASS_CLOSED):f.removeClass(r.__ul,P.CLASS_CLOSED),this.onResize(),r.__closeButton&&(r.__closeButton.innerHTML=e?P.TEXT_OPEN:P.TEXT_CLOSED)}},load:{get:function(){return t.load}},useLocalStorage:{get:function(){return o},set:function(t){O&&(o=t,t?f.bind(window,"unload",e):f.unbind(window,"unload",e),localStorage.setItem(b(r,"isLocal"),t))}}}),p.isUndefined(t.parent)){if(t.closed=!1,f.addClass(this.domElement,P.CLASS_MAIN),f.makeSelectable(this.domElement,!1),O&&o){r.useLocalStorage=!0;var i=localStorage.getItem(b(this,"gui"));i&&(t.load=JSON.parse(i))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=P.TEXT_CLOSED,f.addClass(this.__closeButton,P.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),f.bind(this.__closeButton,"click",function(){r.closed=!r.closed})}else{void 0===t.closed&&(t.closed=!0);var a=document.createTextNode(t.name);f.addClass(a,"controller-name");var s=_(r,a),u=function(t){return t.preventDefault(),r.closed=!r.closed,!1};f.addClass(this.__ul,P.CLASS_CLOSED),f.addClass(s,"title"),f.bind(s,"click",u),t.closed||(this.closed=!1)}t.autoPlace&&(p.isUndefined(t.parent)&&(F&&(B=document.createElement("div"),f.addClass(B,L),f.addClass(B,P.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(B),F=!1),B.appendChild(this.domElement),f.addClass(this.domElement,P.CLASS_AUTO_PLACE)),this.parent||w(r,t.width)),f.bind(window,"resize",function(){r.onResize()}),f.bind(this.__ul,"webkitTransitionEnd",function(){r.onResize()}),f.bind(this.__ul,"transitionend",function(){r.onResize()}),f.bind(this.__ul,"oTransitionEnd",function(){r.onResize()}),this.onResize(),t.resizable&&x(this);r.getRoot();t.parent||n()};return P.toggleHide=function(){D=!D,p.each(H,function(t){t.domElement.style.zIndex=D?-999:999,t.domElement.style.opacity=D?0:1})},P.CLASS_AUTO_PLACE="a",P.CLASS_AUTO_PLACE_CONTAINER="ac",P.CLASS_MAIN="main",P.CLASS_CONTROLLER_ROW="cr",P.CLASS_TOO_TALL="taller-than-window",P.CLASS_CLOSED="closed",P.CLASS_CLOSE_BUTTON="close-button",P.CLASS_DRAG="drag",P.DEFAULT_WIDTH=245,P.TEXT_CLOSED="Close Controls",P.TEXT_OPEN="Open Controls",f.bind(window,"keydown",function(t){"text"===document.activeElement.type||t.which!==R&&t.keyCode!=R||P.toggleHide()},!1),p.extend(P.prototype,{add:function(t,e){return m(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return m(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.slice(this.__controllers.indexOf(t),1);var e=this;p.defer(function(){e.onResize()})},destroy:function(){this.autoPlace&&B.removeChild(this.domElement)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var n=new P(e);this.__folders[t]=n;var r=_(this,n.domElement);return f.addClass(r,"folder"),n},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=f.getOffset(t.__ul).top,n=0;p.each(t.__ul.childNodes,function(e){t.autoPlace&&e===t.__save_row||(n+=f.getHeight(e))}),window.innerHeight-e-N<n?(f.addClass(t.domElement,P.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-N+"px"):(f.removeClass(t.domElement,P.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&p.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},remember:function(){if(p.isUndefined(k)&&(k=new h,k.domElement.innerHTML=e),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;p.each(Array.prototype.slice.call(arguments),function(e){0==t.__rememberedObjects.length&&y(t),-1==t.__rememberedObjects.indexOf(e)&&t.__rememberedObjects.push(e)}),this.autoPlace&&w(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=A(this)),t.folders={},p.each(this.__folders,function(e,n){t.folders[n]=e.getSaveObject()}),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=A(this),S(this,!1)},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered[T]=A(this,!0)),this.load.remembered[t]=A(this),this.preset=t,E(this,t,!0)},revert:function(t){p.each(this.__controllers,function(e){this.getRoot().load.remembered?v(t||this.getRoot(),e):e.setValue(e.initialValue)},this),p.each(this.__folders,function(t){t.revert(t)}),t||S(this.getRoot(),!1)},listen:function(t){var e=0==this.__listening.length;this.__listening.push(t),e&&M(this.__listening)}}),P}(e.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n",e.controllers.factory=function(t,e,n,r,o,i,a){return function(s,u){var l=s[u];
return a.isArray(arguments[2])||a.isObject(arguments[2])?new t(s,u,arguments[2]):a.isNumber(l)?a.isNumber(arguments[2])&&a.isNumber(arguments[3])?new n(s,u,arguments[2],arguments[3]):new e(s,u,{min:arguments[2],max:arguments[3]}):a.isString(l)?new r(s,u):a.isFunction(l)?new o(s,u,""):a.isBoolean(l)?new i(s,u):void 0}}(e.controllers.OptionController,e.controllers.NumberControllerBox,e.controllers.NumberControllerSlider,e.controllers.StringController=function(t,e,n){var r=function(t,n){function o(){a.setValue(a.__input.value)}function i(){a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}r.superclass.call(this,t,n);var a=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),e.bind(this.__input,"keyup",o),e.bind(this.__input,"change",o),e.bind(this.__input,"blur",i),e.bind(this.__input,"keydown",function(t){13===t.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return r.superclass=t,n.extend(r.prototype,t.prototype,{updateDisplay:function(){return e.isActive(this.__input)||(this.__input.value=this.getValue()),r.superclass.prototype.updateDisplay.call(this)}}),r}(e.controllers.Controller,e.dom.dom,e.utils.common),e.controllers.FunctionController,e.controllers.BooleanController,e.utils.common),e.controllers.Controller,e.controllers.BooleanController,e.controllers.FunctionController,e.controllers.NumberControllerBox,e.controllers.NumberControllerSlider,e.controllers.OptionController,e.controllers.ColorController=function(t,e,n,r,o){function i(t,e,n,r){t.style.background="",o.each(u,function(o){t.style.cssText+="background: "+o+"linear-gradient("+e+", "+n+" 0%, "+r+" 100%); "})}function a(t){t.style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var s=function(t,u){function l(t){f(t),e.bind(window,"mousemove",f),e.bind(window,"mouseup",c)}function c(){e.unbind(window,"mousemove",f),e.unbind(window,"mouseup",c)}function d(){var t=r(this.value);t!==!1?(m.__color.__state=t,m.setValue(m.__color.toOriginal())):this.value=m.__color.toString()}function h(){e.unbind(window,"mousemove",p),e.unbind(window,"mouseup",h)}function f(t){t.preventDefault();var n=e.getWidth(m.__saturation_field),r=e.getOffset(m.__saturation_field),o=(t.clientX-r.left+document.body.scrollLeft)/n,i=1-(t.clientY-r.top+document.body.scrollTop)/n;return i>1?i=1:0>i&&(i=0),o>1?o=1:0>o&&(o=0),m.__color.v=i,m.__color.s=o,m.setValue(m.__color.toOriginal()),!1}function p(t){t.preventDefault();var n=e.getHeight(m.__hue_field),r=e.getOffset(m.__hue_field),o=1-(t.clientY-r.top+document.body.scrollTop)/n;return o>1?o=1:0>o&&(o=0),m.__color.h=360*o,m.setValue(m.__color.toOriginal()),!1}s.superclass.call(this,t,u),this.__color=new n(this.getValue()),this.__temp=new n(0);var m=this;this.domElement=document.createElement("div"),e.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",e.bind(this.__input,"keydown",function(t){13===t.keyCode&&d.call(this)}),e.bind(this.__input,"blur",d),e.bind(this.__selector,"mousedown",function(){e.addClass(this,"drag").bind(window,"mouseup",function(){e.removeClass(m.__selector,"drag")})});var _=document.createElement("div");o.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),o.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),o.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),o.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),o.extend(_.style,{width:"100%",height:"100%",background:"none"}),i(_,"top","rgba(0,0,0,0)","#000"),o.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),a(this.__hue_field),o.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),e.bind(this.__saturation_field,"mousedown",l),e.bind(this.__field_knob,"mousedown",l),e.bind(this.__hue_field,"mousedown",function(t){p(t),e.bind(window,"mousemove",p),e.bind(window,"mouseup",h)}),this.__saturation_field.appendChild(_),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};s.superclass=t,o.extend(s.prototype,t.prototype,{updateDisplay:function(){var t=r(this.getValue());if(t!==!1){var e=!1;o.each(n.COMPONENTS,function(n){return o.isUndefined(t[n])||o.isUndefined(this.__color.__state[n])||t[n]===this.__color.__state[n]?void 0:(e=!0,{})},this),e&&o.extend(this.__color.__state,t)}o.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var a=this.__color.v<.5||this.__color.s>.5?255:0,s=255-a;o.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+a+","+a+","+a+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,i(this.__saturation_field,"left","#fff",this.__temp.toString()),o.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+a+","+a+","+a+")",textShadow:this.__input_textShadow+"rgba("+s+","+s+","+s+",.7)"})}});var u=["-moz-","-o-","-webkit-","-ms-",""];return s}(e.controllers.Controller,e.dom.dom,e.color.Color=function(t,e,n,r){function o(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(a(this,e,n),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(a(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function i(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(s(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(s(this),this.__state.space="HSV"),this.__state[e]=t}})}function a(t,n,o){if("HEX"===t.__state.space)t.__state[n]=e.component_from_hex(t.__state.hex,o);else{if("HSV"!==t.__state.space)throw"Corrupted color state";r.extend(t.__state,e.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}}function s(t){var n=e.rgb_to_hsv(t.r,t.g,t.b);r.extend(t.__state,{s:n.s,v:n.v}),r.isNaN(n.h)?r.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=n.h}var u=function(){if(this.__state=t.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return u.COMPONENTS=["r","g","b","h","s","v","hex","a"],r.extend(u.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),o(u.prototype,"r",2),o(u.prototype,"g",1),o(u.prototype,"b",0),i(u.prototype,"h"),i(u.prototype,"s"),i(u.prototype,"v"),Object.defineProperty(u.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(u.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=e.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),u}(e.color.interpret,e.color.math=function(){var t;return{hsv_to_rgb:function(t,e,n){var r=Math.floor(t/60)%6,o=t/60-Math.floor(t/60),i=n*(1-e),a=n*(1-o*e),s=n*(1-(1-o)*e),u=[[n,s,i],[a,n,i],[i,n,s],[i,a,n],[s,i,n],[n,i,a]][r];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(t,e,n){var r,o,i=Math.min(t,e,n),a=Math.max(t,e,n),s=a-i;return 0==a?{h:0/0,s:0,v:0}:(o=s/a,r=t==a?(e-n)/s:e==a?2+(n-t)/s:4+(t-e)/s,r/=6,0>r&&(r+=1),{h:360*r,s:o,v:a/255})},rgb_to_hex:function(t,e,n){var r=this.hex_with_component(0,2,t);return r=this.hex_with_component(r,1,e),r=this.hex_with_component(r,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(e,n,r){return r<<(t=8*n)|e&~(255<<t)}}}(),e.color.toString,e.utils.common),e.color.interpret,e.utils.common),e.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),e.dom.CenteredDiv=function(t,e){var n=function(){this.backgroundElement=document.createElement("div"),e.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"}),t.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),e.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var n=this;t.bind(this.backgroundElement,"click",function(){n.hide()})};return n.prototype.show=function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),e.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})},n.prototype.hide=function(){var e=this,n=function(){e.domElement.style.display="none",e.backgroundElement.style.display="none",t.unbind(e.domElement,"webkitTransitionEnd",n),t.unbind(e.domElement,"transitionend",n),t.unbind(e.domElement,"oTransitionEnd",n)};t.bind(this.domElement,"webkitTransitionEnd",n),t.bind(this.domElement,"transitionend",n),t.bind(this.domElement,"oTransitionEnd",n),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},n.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-t.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-t.getHeight(this.domElement)/2+"px"},n}(e.dom.dom,e.utils.common),e.dom.dom,e.utils.common)},function(t){var e=t.exports=e||{};e.color=e.color||{},e.utils=e.utils||{},e.utils.common=function(){var t=Array.prototype.forEach,e=Array.prototype.slice;return{BREAK:{},extend:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(e[n])||(t[n]=e[n])},this),t},defaults:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(t[n])&&(t[n]=e[n])},this),t},compose:function(){var t=e.call(arguments);return function(){for(var n=e.call(arguments),r=t.length-1;r>=0;r--)n=[t[r].apply(this,n)];return n[0]}},each:function(e,n,r){if(t&&e.forEach===t)e.forEach(n,r);else if(e.length===e.length+0){for(var o=0,i=e.length;i>o;o++)if(o in e&&n.call(r,e[o],o)===this.BREAK)return}else for(var o in e)if(n.call(r,e[o],o)===this.BREAK)return},defer:function(t){setTimeout(t,0)},toArray:function(t){return t.toArray?t.toArray():e.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){return t!==t},isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return t===!1||t===!0},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}}}(),e.color.toString=function(t){return function(e){if(1==e.a||t.isUndefined(e.a)){for(var n=e.hex.toString(16);n.length<6;)n="0"+n;return"#"+n}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}}(e.utils.common),e.Color=e.color.Color=function(t,e,n,r){function o(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(a(this,e,n),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(a(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function i(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(s(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(s(this),this.__state.space="HSV"),this.__state[e]=t}})}function a(t,n,o){if("HEX"===t.__state.space)t.__state[n]=e.component_from_hex(t.__state.hex,o);else{if("HSV"!==t.__state.space)throw"Corrupted color state";r.extend(t.__state,e.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}}function s(t){var n=e.rgb_to_hsv(t.r,t.g,t.b);r.extend(t.__state,{s:n.s,v:n.v}),r.isNaN(n.h)?r.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=n.h}var u=function(){if(this.__state=t.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return u.COMPONENTS=["r","g","b","h","s","v","hex","a"],r.extend(u.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),o(u.prototype,"r",2),o(u.prototype,"g",1),o(u.prototype,"b",0),i(u.prototype,"h"),i(u.prototype,"s"),i(u.prototype,"v"),Object.defineProperty(u.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(u.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=e.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),u}(e.color.interpret=function(t,e){var n,r,o=function(){r=!1;var t=arguments.length>1?e.toArray(arguments):arguments[0];return e.each(i,function(o){return o.litmus(t)?(e.each(o.conversions,function(o,i){return n=o.read(t),r===!1&&n!==!1?(r=n,n.conversionName=i,n.conversion=o,e.BREAK):void 0}),e.BREAK):void 0}),r},i=[{litmus:e.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:t},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null===e?!1:{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:t},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:t},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null===e?!1:{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:t}}},{litmus:e.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:e.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4!=t.length?!1:{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:e.isObject,conversions:{RGBA_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)&&e.isNumber(t.a)?{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)?{space:"RGB",r:t.r,g:t.g,b:t.b}:!1},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)&&e.isNumber(t.a)?{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)?{space:"HSV",h:t.h,s:t.s,v:t.v}:!1},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}];return o}(e.color.toString,e.utils.common),e.color.math=function(){var t;return{hsv_to_rgb:function(t,e,n){var r=Math.floor(t/60)%6,o=t/60-Math.floor(t/60),i=n*(1-e),a=n*(1-o*e),s=n*(1-(1-o)*e),u=[[n,s,i],[a,n,i],[i,n,s],[i,a,n],[s,i,n],[n,i,a]][r];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(t,e,n){var r,o,i=Math.min(t,e,n),a=Math.max(t,e,n),s=a-i;return 0==a?{h:0/0,s:0,v:0}:(o=s/a,r=t==a?(e-n)/s:e==a?2+(n-t)/s:4+(t-e)/s,r/=6,0>r&&(r+=1),{h:360*r,s:o,v:a/255})},rgb_to_hex:function(t,e,n){var r=this.hex_with_component(0,2,t);return r=this.hex_with_component(r,1,e),r=this.hex_with_component(r,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(e,n,r){return r<<(t=8*n)|e&~(255<<t)}}}(),e.color.toString,e.utils.common)}]);